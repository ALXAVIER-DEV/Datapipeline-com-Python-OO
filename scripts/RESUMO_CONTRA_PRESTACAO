/*
COMBINAÇÃO DCMS (PLANOS) – Não tem no Cloud

Descrição do código CLOUD - RA_CUST_TRX_TYPES_ALL .NAME

Descrição – RA_CUST_TRX_TYPES_ALL .DESCRIPTION

'Código  CLOUD TIPO DE TRANSAÇÃO NÃO PLANO' - AR_MEMO_LINES_ALL_TL.NAME

Código  CLOUD concatenado com combinação produto = AR_MEMO_LINES_ALL_TL.NAME
*/


WITH  RESUMO_CONTRA_PRESTACAO AS (
SELECT CAST(CAST(CUST.SET_ID AS FLOAT) AS BIGINT) CUST_SET_ID  ,CUST.NAME AS 'TIPO TRANSACAO CLOUD', CUST.DESCRIPTION AS 'Descrição do código CLOUD', ARL.NAME 'Código  CLOUD TIPO DE TRANSAÇÃO NÃO PLANO', ARL.DESCRIPTION
FROM   [FUSION].[OCI_RA_CUST_TRX_TYPES_ALL] CUST
INNER JOIN [FUSION].[OCI_AR_MEMO_LINES_ALL_TL] ARL ON 
CUST.SET_ID = ARL.SET_ID
WHERE CUST.NAME IN('PF-MENSAL (PRE)',
'PF-MENSAL (MISTO)',
'PF-ANUAL (PRE)',
'PF-ANUAL (MISTO)',
'PJ-MENSAL (PRE)',
'PJ-MENS (PRE) PUBL',
'PJ-MENS (PRE) ISS',
'PJ-MENSAL (MISTO)',
'PJ-MENS (MISTO) PUBL',
'PJ-MENS (MISTO) ISS',
'PJ-CORRESP (PRE)',
'PJ-CORR (PRE) PUB',
'PJ-CORR (PRE) ISS',
'PJ-CORR (MISTO)',
'PJ-CORR (MISTO) PUB',
'PJ-CORR (MISTO) ISS',
'PJ-ANUAL (PRE)',
'PJ-ANUAL (MISTO)',
'PF-CORRESP (PRE)',
'PF-CORR (MISTO)',
'PF-MENSAL (PRE) C',
'PF-MENSAL (MISTO) C',
'PF-ANUAL (PRE) C',
'PF-ANUAL (MISTO) C',
'PJ-MENSAL (PRE) C',
'PJ-MENS (PRE) PUBL C',
'PJ-MENS (PRE) ISS C',
'PJ-MENSAL (MISTO) C',
'PJ-MENS(MISTO)PUBL C',
'PJ-MENS (MISTO)ISS C',
'PJ-CORRESP (PRE) C',
'PJ-CORR (PRE) PUB C',
'PJ-CORR (PRE) ISS C',
'PJ-CORR (MISTO) C',
'PJ-CORR (MISTO)PUB C',
'PJ-CORR (MISTO)ISS C',
'PJ-ANUAL (PRE) C',
'PJ-ANUAL (MISTO) C',
'PF-CORRESP (PRE) C',
'PF-CORR (MISTO) C',
'PF-MENSAL (PRE) R',
'PF-MENSAL (MISTO) R',
'PF-ANUAL (PRE) R',
'PF-ANUAL (MISTO) R',
'PJ-MENSAL (PRE) R',
'PJ-MENS (PRE) PUBL R',
'PJ-MENS (PRE) ISS R',
'PJ-MENSAL (MISTO) R',
'PJ-MENS(MISTO)PUBL R',
'PJ-MENS (MISTO)ISS R',
'PJ-CORRESP (PRE) R',
'PJ-CORR (PRE) PUB R',
'PJ-CORR (PRE) ISS R',
'PJ-CORR (MISTO) R',
'PJ-CORR (MISTO)PUB R',
'PJ-CORR (MISTO)ISS R',
'PJ-ANUAL (PRE) R',
'PJ-ANUAL (MISTO) R',
'PF-CORRESP (PRE) R',
'PF-CORR (MISTO) R',
'PJ-MENSAL (PRE)',
'PF-MENSAL (PRE)',
'PJ-CORRESP (PRE)') 
AND ARL.DESCRIPTION <> 'NAO USAR'
AND ARL.NAME IN(
'(-) AJUSTE DE MOV.CADASTRAL',
'(-)DESCONTO CONCEDIDO',
'(+) Adicional de Contrato',
'(+) AJUSTE DE MOV.CADASTRAL',
'(+) AJUSTE RETROATIVO',
'COMP PL ADESAO',
'COMP PL INDIVIDUAL',
'OPER ODONTOLOGICO',
'OPER ODONTOLOGICO',
'OPER ODONT PF DA',
'REAJ COM INDIVIDUAL',
'REAJ COMP EMPRES',
'REAJ COMP ADESAO',
'COMP PL ADESAO',
'COMP PL INDIVIDUAL',
'OPER ODONTOLOGICO',
'OPER ODONTOLOGICO',
'OPER ODONT PF DA',
'REAJ COM INDIVIDUAL',
'REAJ COMP EMPRES',
'REAJ COMP ADESAO',
'CORRESP ASSUMIDA'
)
-- GROUP BY 
-- CUST.SET_ID
-- ,CUST.CREDIT_MEMO_TYPE_ID
-- ,CUST.NAME
-- ,CUST.DESCRIPTION
-- ,ARL.NAME
-- ,ARL.DESCRIPTION
)

SELECT * FROM RESUMO_CONTRA_PRESTACAO
